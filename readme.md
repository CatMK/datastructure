second update:
datastructure is fuc*ing hard!
datastructure is update_master hard!
